# RecommenderSystem

### Baseline model

将用户评分定义为全局平均分 + 用户bias + 物品 bias

$$
rating = u + b_{u} + b_{i}
$$


### Latent Facotr Model（LFM） 隐语义模型 

用 FunkSVD将item-user 矩阵分解为两个矩阵P and Q的乘积





# 1 BIADS.ADS_RCM_LONGVIDEO_COMMON_USER_PLAY_RECORD_LOG_DM


```mermaid
graph LR;

    %% D fifth layer 
    D1_2_1_1[ODS_DELETE_RCMACTIVITYLOG_DM]-->D1_2_1;


    %% D fourth layer
    D1_2_1[ADS_RCM_VIDEO_BASE_USER_DELETE_RCMACTIVITY_LOG_DM]-->D1_2;
    D1_2_2[ADS_RCM_VIDEO_COMMON_USER_VIDEO_PLAY_LOG_DM]-->D1_2;
    D2_1_1[DIM_VIDEO_FIRST_CLASS_MAP_DM]-->D2_1;
    D2_2_1[DIM_VIDEO_ARTIST_INFO_DM]-->D2_2;
    D2_3_1[DIM_VIDEO_ARTIST_MULTI_LANGUAGE_INFO_DM]-->D2_3;
    D2_4_1[ADS_RCM_VIDEO_BASE_VIDEO_ARTIST_MULTI_LANGUAGE_INFO_DM]-->D2_4;


    %% D third layer
    D1_1[ADS_RCM_VIDEO_COMMON_USER_VIDEO_PLAY_LOG_DM <br> Table 5 in this document]-->D1;
    D1_2[ADS_RCM_VIDEO_COMMON_USER_VIDEO_PLAY_DELETE_ACTIVITY_LOG_DM]-->D1;
    D2_1[ADS_RCM_VIDEO_BASE_VIDEO_FIRST_CLASS_MAP_DM]-->D2;
    D2_2[ADS_RCM_VIDEO_BASE_VIDEO_ARTIST_INFO_DM]-->D2;
    D2_3[ADS_RCM_VIDEO_BASE_VIDEO_ARTIST_MULTI_LANGUAGE_INFO_DM]-->D2;
    D2_4[ADS_RCM_VIDEO_COMMON_VIDEO_INFO_DM]-->D2;
    D2_5[ADS_RCM_VIDEO_BASE_VIDEO_SECOND_CLASS_MAP_DM]-->D2;

    %% C third layer
    C1_1[ODS_VIDEO_RCMSCENARIO_INFO_HM]-->C1;


    %% D second layer
    D1[ADS_RCM_VIDEO_COMMON_USER_PLAY_DELETE_RCMACTIVITY_DM]-->D;
    D2[ADS_RCM_LONGVIDEO_COMMON_VIDEO_INFO_DS]-->D;

    %% C second layer
    C1[DIM_VIDEO_SCENE_INFO_HM]-->C;




    %% first layer
    D[ADS_RCM_LONGVIDEO_COMMON_USER_VIDEO_PLAY_EVENTS_DM]-->A[ADS_RCM_LONGVIDEO_COMMON_USER_PLAY_RECORD_LOG_DM];
    C[ADS_RCM_VIDEO_BASE_VIDEO_SCENE_INFO_HM  <br> Table C]-->A[ADS_RCM_LONGVIDEO_COMMON_USER_PLAY_RECORD_LOG_DM];
    B[ADS_RCM_LONGVIDEO_COMMON_VIDEO_INFO_DS <br> See table 3 in this document]-->A[ADS_RCM_LONGVIDEO_COMMON_USER_PLAY_RECORD_LOG_DM];

    style B fill:#440,stroke:#333,stroke-width:4px
    style D1_1 fill:#440,stroke:#333,stroke-width:4px
```

# 2 BIADS.ADS_RCM_VIDEO_BASE_VIDEO_INFO_BE_DM

```mermaid
graph LR;
    %% first layer
    F[DIM_VIDEO_BASE_INFO_BE_DM]-->E[ADS_RCM_VIDEO_BASE_VIDEO_INFO_BE_DM];
    style E fill:#090,stroke:#333,stroke-width:4px
```

# 3 BIADS.ADS_RCM_LONGVIDEO_COMMON_VIDEO_INFO_DS

```mermaid
graph LR;

    %% B fifth layer
    B4_1_1_1[ADS_RCM_VIDEO_BASE_VIDEO_INFO_DM]-->B4_1_1;
    B4_2_1_1[ODS_VIDEO_CLOUD_BE_COUNTRY_MAP_DM]-->B4_2_1;
    B4_4_1_1[ODS_VIDEO_EPISODE_INFO_MULTILANGUAGE_HM]-->B4_4_1;
    B4_4_2_1[DIM_VIDEO_EPISODE_SP_INFO_BE_HM]-->B4_4_2;
    B4_4_3_1[DIM_VIDEO_EPISODE_INFO_SP_HM]-->B4_4_3;

    B4_4_4_1[DIM_VIDEO_BASE_INFO_ORI_HM]-->B4_4_4;
    B4_4_4_2[ODS_VIDEO_LIVECHANNEL_BASE_INFO_MULTILANGUAGE_DM]-->B4_4_4;
    B4_4_4_3[DIM_VIDEO_BASE_INFO_MULTILANGUAGE_HM]-->B4_4_4;
    B4_4_4_4[DIM_VIDEO_BASE_INFO_BE_HM]-->B4_4_4;
    B4_4_4_5[DIM_VIDEO_SP_INFO_DM]-->B4_4_4;
    B4_4_4_6[ODS_VIDEO_CLOUD_BE_COUNTRY_MAP_DM]-->B4_4_4;
    B4_4_4_7[DIM_VIDEO_EPISODE_INFO_HM]-->B4_4_4;
    B4_4_4_8[DIM_VIDEO_EPISODE_INFO_MULTILANGUAGE_DM]-->B4_4_4;
    B4_4_4_9[DIM_VIDEO_EPISODE_INFO_SP_HM]-->B4_4_4;
    B4_4_4_10[ODS_VIDEO_PRI_CAT_INFO_DM]-->B4_4_4;

    B4_4_6_1[DIM_VIDEO_EPISODE_INFO_HM]-->B4_4_6;
    B4_6_2_1[ADS_RCM_VIDEO_BASE_VIDEO_SCENE_INFO_HM  <br> Table C]-->B4_6_2;
    B4_7_1_1[ODS_VIDEO_BASE_INFO_SP_HM]-->B4_7_1;

    %% B fourth layer
    B1_1_1[ODS_VIDEO_PRI_CAT_INFO_DM]-->B1_1;
    
    B2_1_1[ODS_VIDEO_ARTIST_DM]-->B2_1;
    B2_1_2[ODS_VIDEO_ARTIST_MULTILANGUAGE_DM]-->B2_1;

    B3_1_1[ODS_VIDEO_BASE_INFO_DM]-->B3_1;
    B3_1_2[ODS_VIDEO_LIVECHANNEL_BASE_INFO_MULTILANGUAGE_DM]-->B3_1;
    B3_1_3[ODS_VIDEO_BASE_INFO_MULTILANGUAGE_DM]-->B3_1;

    B4_1_1[ADS_RCM_VIDEO_COMMON_VIDEO_METADATA_DETECTED_LANGUAGE_LANGID_DM]-->B4_1;
    B4_2_1[DIM_VIDEO_CLOUD_BE_COUNTRY_MAP_DM]-->B4_2;
    B4_3_1[N/A]-->B4_3;  
    B4_4_1[DIM_VIDEO_EPISODE_INFO_MULTILANGUAGE_DM]-->B4_4;
    B4_4_2[ADS_RCM_VIDEO_BASE_EPISODE_SP_INFO_BE_DM]-->B4_4;
    B4_4_3[ADS_RCM_VIDEO_BASE_EPISODE_INFO_SP_DM]-->B4_4;
    B4_4_4[DIM_VIDEO_BASE_INFO_DM]-->B4_4;
    B4_4_5[ADS_RCM_VIDEO_BASE_VIDEO_SP_INFO_DM]-->B4_4;
    B4_4_6[ADS_RCM_VIDEO_BASE_EPISODE_INFO_DM]-->B4_4;
    B4_5_1[DIM_VIDEO_ARTIST_INFO_DM]-->B4_5;
    B4_6_1[ADS_RCM_VIDEO_BASE_VIDEO_INFO_DM]-->B4_6;
    B4_6_2[ADS_RCM_VIDEO_COMMON_VIDEO_MULTIRULE_SCENE_INFO_DM]-->B4_6;
    B4_7_1[DIM_VIDEO_SP_INFO_DM]-->B4_7;
    B4_8_1[N/A]-->B4_8;

    B5_1_1[ODS_VIDEO_SEC_CAT_INFO_DM]-->B5_1;


    %% B third layer
    B1_1[DIM_VIDEO_FIRST_CLASS_MAP_DM]-->B1;
    B2_1[DIM_VIDEO_ARTIST_INFO_DM]-->B2;
    B3_1[DIM_VIDEO_ARTIST_MULTI_LANGUAGE_INFO_DM]-->B3;
    B4_1[ADS_RCM_VIDEO_COMMON_VIDEO_DETECTED_LANGUAGE_DS]-->B4;
    B4_2[ADS_RCM_VIDEO_CLOUD_BE_COUNTRY_MAP_DM]-->B4;
    B4_3[ADS_RCM_VIDEO_COMMON_VIDEO_MANUAL_COUNTRY_RELEVANCY_INFO_DM]-->B4;
    B4_4[ADS_RCM_VIDEO_BASE_VIDEO_INFO_DM]-->B4;
    B4_5[ADS_RCM_VIDEO_BASE_VIDEO_ARTIST_INFO_DM]-->B4;
    B4_6[ADS_RCM_VIDEO_COMMON_VIDEO_SCENE_INFO_DM_JSON]-->B4;
    B4_7[ADS_RCM_VIDEO_BASE_VIDEO_SP_INFO_DM]-->B4;
    B4_8[ADS_RCM_VIDEO_COMMON_VIDEO_MANUAL_UPLOADER_LANG_RELEVANCY_INFO_DM]-->B4;
    B5_1[DIM_VIDEO_SECOND_CLASS_MAP_DM]-->B5;

    %% B second layer
    B1[ADS_RCM_VIDEO_BASE_VIDEO_FIRST_CLASS_MAP_DM]-->B[ADS_RCM_LONGVIDEO_COMMON_VIDEO_INFO_DS];
    B2[ADS_RCM_VIDEO_BASE_VIDEO_ARTIST_INFO_DM]-->B;
    B3[ADS_RCM_VIDEO_BASE_VIDEO_ARTIST_MULTI_LANGUAGE_INFO_DM]-->B;
    B4[ADS_RCM_VIDEO_COMMON_VIDEO_INFO_DM]-->B;
    B5[ADS_RCM_VIDEO_BASE_VIDEO_SECOND_CLASS_MAP_DM]-->B;
    
    
    style B4_4 fill:#900,stroke:#333,stroke-width:4px
    style B4_4_3 fill:#900,stroke:#333,stroke-width:4px
    style B4_4_2 fill:#900,stroke:#333,stroke-width:4px
    style B4_4_6 fill:#900,stroke:#333,stroke-width:4px
    style B4_4_5 fill:#900,stroke:#333,stroke-width:4px

    
```

# 4 ADS_RCM_LONGVIDEO_COMMON_VIDEO_INFO_BE_DM


```mermaid
graph LR;
    %% first layer
    H[ADS_RCM_LONGVIDEO_COMMON_VIDEO_INFO_DS <br> table 3 in this document]-->G[ADS_RCM_LONGVIDEO_COMMON_VIDEO_INFO_BE_DM];
    I[ADS_RCM_VIDEO_BASE_VIDEO_INFO_BE_DM <br> table 2 in this document]-->G;

```

# 5 ADS_RCM_VIDEO_COMMON_USER_VIDEO_PLAY_LOG_DM

```mermaid
graph LR;
    %% D sixth layer  
    D1_1_5_1_1[DIM_VIDEO_PLAY_EVENT_DM]-->D1_1_5_1;
    D1_1_5_2_1[DIM_UP_USER_UNREGISTRATION_DM]-->D1_1_5_2; 
    D1_1_5_2_2[DIM_VIDEO_USER_LOGINAUTH_DM]-->D1_1_5_2; 


    %% D fifth layer
    D1_1_2_1[DIM_VIDEO_CATALOG_MULTI_LANGUAGE_INFO_DM]-->D1_1_2;
    D1_1_3_1[DIM_VIDEO_CLOUD_BE_COUNTRY_MAP_DM]-->D1_1_3;
    D1_1_4_1[DIM_VIDEO_CATALOG_DATA_DM]-->D1_1_4;    
    D1_1_5_1[ADS_RCM_VIDEO_BASE_USER_VIDEO_PLAY_RECORD_LOG_DM]-->D1_1_5;
    D1_1_5_2[ADS_RCM_VIDEO_BASE_PERSONAL_REC_DISABLED_USERS_DM]-->D1_1_5; 

    %% D fourth layer
    D1_1_1[ADS_RCM_VIDEO_COMMON_VIDEO_INFO_DM]-->D1_1[ADS_RCM_VIDEO_COMMON_USER_VIDEO_PLAY_LOG_DM];
    D1_1_2[ADS_RCM_VIDEO_BASE_CATALOG_MULTI_LANGUAGE_INFO_DM]-->D1_1;
    D1_1_3[ADS_RCM_VIDEO_CLOUD_BE_COUNTRY_MAP_DM]-->D1_1;
    D1_1_4[ADS_RCM_VIDEO_BASE_VIDEO_CATALOG_DATA_DM]-->D1_1;
    D1_1_5[ADS_RCM_VIDEO_BASE_USER_VIDEO_PLAY_RECORD_LOG_DM_OBJECT]-->D1_1;

    style D1_1_5_1 fill:#090,stroke:#333,stroke-width:4px
    style D1_1_4 fill:#090,stroke:#333,stroke-width:4px
    style D1_1_3 fill:#090,stroke:#333,stroke-width:4px
    style D1_1_2 fill:#090,stroke:#333,stroke-width:4px
    style D1_1_5_2 fill:#090,stroke:#333,stroke-width:4px
    style D1_1_5 fill:#900,stroke:#333,stroke-width:4px
```

# 6 ADS_RCM_VIDEO_BASE_DRAMA_INFO_DM

```mermaid
graph LR;

    K[DIM_VIDEO_DRAMA_INFO_DM]-->J[ADS_RCM_VIDEO_BASE_DRAMA_INFO_DM];
    style J fill:#090,stroke:#333,stroke-width:4px

```

# 7 ADS_RCM_LONGVIDEO_BASE_VIDEO_VISITOR_STAT_DM

```mermaid
graph LR;

    M[ADS_RCM_VIDEO_BASE_VIDEO_SCENE_INFO_HM <br> Table C]-->L[ADS_RCM_LONGVIDEO_BASE_VIDEO_VISITOR_STAT_DM];
    N[ODS_VIDEO_COLUMN_INFO_DM]-->L;
    O[DIM_VIDEO_POSITION_BEHAVIOR_DM]-->L;
    P[ADS_RCM_VIDEO_BASE_VIDEO_INFO_DM <br> In one of the table in table 3 in this doc]-->L;

```
